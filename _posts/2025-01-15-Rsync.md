---
title: 'Rsync使用'
date: 2025-01-15
tags:
  - Rsync
  - 文档
---

在 `rsync` 命令中，使用不同的标志和输出标识来表示文件的状态以及需要执行的操作。以下是关于 `rsync` 命令输出的说明和如何更新的解释：

### 1. **rsync命令标志和输出解释**:

- **`>`**: 文件在远程服务器上存在，因此从远程复制到本地。来自于Compare Remote to Local(检查远程多于本地的文件)
- **`<`**: 目录在本地存在，远程不存在。来自于Compare Local to Remote(检查本地多于远程的文件)
- **`t`**: 文件时间戳不同，需要更新文件的时间戳。
- **`s`**: 文件的内容大小。
- **`.`**: 表示文件或目录结构在远程和本地相同，但其属性有所不同。
- **`c`**: 文件属性有所不同，需要更新文件的权限或其他属性。
- **`d`**: 这是一个目录。'f'代表一个文件

  
### 2. **标志和输出样例说明**:

- **`[>f+++++++]`**: 该文件在远程服务器上不存在，`rsync` 会将其从本地复制到远程服务器。
- **`[cd+++++++]`**: 目录在本地不存在，`rsync` 会创建该目录及其内容。
- **`[.d..t....]`**: 目录在远程和本地结构相同，但时间戳不同，`rsync` 仅更新时间戳。
- **`[>f.st....]`**: 文件内容不同，并且文件的时间戳和权限也有所不同，因此需要更新文件。
- **`[>f..t....]`**: 文件内容相同，但时间戳不同，因此仅更新时间戳。

### 3. **如何更新**:

- 在实际运行 `rsync` 时（不使用 `-n` 选项），文件会根据这些标志执行相应的操作：
  - 如果文件需要从本地同步到远程服务器，它会显示 `>`，并执行复制操作。
  - 如果文件已经存在但时间戳不同，则会仅更新时间戳，显示为 `[.d..t....]` 或 `[>f..t....]`。
  - 如果文件在远程服务器上不存在，`rsync` 会从本地复制文件，显示为 `[>f+++++++]`。

### 4. **相关的rsync命令和选项**:

```bash
rsync -rlptzv --progress --exclude=.vscode --exclude=.git --exclude=*.DS_Store --exclude=*.vtk --exclude=*.safetensor --exclude=*.pvd --exclude=*.mat --exclude=*.vtu -ahH --bwlimit=40000000 --partial --out-format='[%t] [%i] (Last Modified: %M) (bytes: %-10l) %-100n' jiashhu@ws9:/home/jiashhu/HarmonicMapping/ /Users/liubocheng/Documents/2024/HamonicMap/
```

- **`-n`**: 模拟运行，查看哪些文件会被同步，而不实际执行任何操作。适用于检查和对比文件的状态。
- **`-r`**: 递归复制目录。
- **`-l`**: 复制符号链接。
- **`-p`**: 保留文件的权限。
- **`-t`**: 保留文件的时间戳。
- **`-z`**: 启用压缩。
- **`-v`**: 启用详细输出。
- **`--bwlimit`**: 限制带宽使用（例如，限制为 40MB/s）。

### 5. **更新的步骤**:

如果您希望实际同步文件，而非仅比较文件，可以执行 `rsync` 命令而不使用 `-n` 模式。当使用 `-n` 查看输出后，您可以根据输出中的状态来判断哪些文件或目录需要更新，并通过执行实际的 `rsync` 命令来完成更新。

